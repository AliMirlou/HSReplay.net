{% extends "account/base.html" %}
{% load feature from features %}

{% block content %}
	<form action="" method="post" id="account-form">
		{% csrf_token %}

		<section id="account-locale" class="box-section">
			<h3>Preferences</h3>
			<div class="inner">
				<p>
					Enable or disable auto-play of replays on the site.
				</p>
				<p>
					<label>
						{{ form.joust_autoplay }}
						Automatically play replays when viewing them
					</label>
				</p>
			</div>
		</section>

		<section id="account-privacy" class="box-section">
			<h3>Privacy</h3>
			<div class="inner">
				<p>
					You can currently choose between two privacy options:
				</p>
				<dl class="dl-horizontal">
					<dt>Public</dt>
					<dd>Your replays may be appear in listings such as <em>Related games</em></dd>
					<dt>Unlisted</dt>
					<dd>Your replays will not appear in such listings. Anyone you share the link to a specific replay with will still be able to view it, though.</dd>
				</dl>
				<p>
					Changing this option will only affect newly uploaded replays.
				</p>
				<p>
					{{ form.default_replay_visibility }}
				</p>
				<p class="help-block">
					You can always change the visibility for a specific replay on the replay's page.
				</p>
			</div>
		</section>

		<section id="collection" class="box-section">
			<h3>Collection Uploading</h3>
			<div class="inner">
				<p>
					You can upload your collection using Hearthstone Deck Tracker.
					Once you've uploaded your collection, we will show you personal dust costs and missing cards.
				</p>
				<p>
					<label>
						<input
							id="collection_syncing_checkbox"
							type="checkbox"
							{% if collection_syncing %}checked{% endif %}
						/> Enable personal Hearthstone collection features on the site
					</label>
					<script type="text/javascript">
					document.getElementById("collection_syncing_checkbox").onchange = function(e) {
						if (e.target.checked) {
							// delete cookie
							document.cookie = "disable-collection=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/"
						} else {
							// set "disabled" cookie
							var d = new Date();
							d.setFullYear(d.getFullYear() + 1);
							document.cookie = "disable-collection=true; expires=" + d.toUTCString() + "; path=/";
						}
					}
					</script>
				</p>
			</div>
		</section>

		<section id="account-statistics" class="box-section">
			<h3>Statistics contributions</h3>
			<div class="inner">
				<p>
					We analyze games uploaded to HSReplay.net to provide data for
					<a href="{% url 'premium' %}">HSReplay.net Premium</a> and sometimes publish
					findings in our <a href="https://articles.hsreplay.net/" target="_blank">Articles</a> and
					on the <a href="https://hearthsim.info/">HearthSim Blog</a>.<br/>
					<strong>The data is always entirely anonymous and aggregate.</strong>
				</p>
				<p>
					If you want your data to be excluded from these public results, you can check the option
					below.
				</p>
				<p class="alert alert-warning">
					This option will also prevent new games from appearing in personalized premium features such as My Decks, My Cards and My Statistics for now.<br />
				</p>
				<p>
					<label>
						{{ form.exclude_from_statistics }}
						Exclude my data from aggregate statistics
					</label>
				</p>
			</div>
		</section>

		{% if reflink and not reflink.disabled %}
		<section id="refer-a-friend" class="box-section">
			<h3>Refer a friend!</h3>
			<div class="inner">
				<p>
					Love the site? Share it with your friends!
					Send them your personalized referral link and earn <strong>$2.50 USD</strong> of Premium credit the first time they subscribe to <a href="/premium/">HSReplay.net Premium</a>!
				</p>

				<p class="text-center">
					<strong style="font-size: 1.5em"><a href="{{ reflink.get_absolute_url }}">https://hsreplay.net{{ reflink.get_absolute_url }}</a></strong>
				</p>

				{% if hits %}
				<p>
					You have referred <strong>{{ hits }} friend{{ hits|pluralize }}</strong> so far. Keep it up!
				</p>
				{% endif %}
			</div>
		</section>
		{% endif %}
		<p>
			<button type="submit" class="btn btn-primary">Update settings</button>
		</p>
	</form>
{% endblock %}
